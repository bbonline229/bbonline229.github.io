{"title":"Closure in Swift 5 - Part 2 (使用高階函數)","date":"2019-05-19T16:51:53.000Z","link":"2019/05/20/closure2","tags":["swift"],"updated":"2019-08-01T04:28:14.680Z","content":"<p><strong>Part1 把 closure 語法及簡化過程都講完了<br>剛好用內建的高階函數來練習簡化 closure</strong></p>\n<br>\n\n<h1 id=\"常用高階函數-Higher-order-function\">常用高階函數 (Higher-order function)<a href=\"2019/05/20/closure2#常用高階函數-Higher-order-function\"></a></h1><h3 id=\"map\">map( )<a href=\"2019/05/20/closure2#map\"></a></h3><h3 id=\"flatMap\">flatMap( )<a href=\"2019/05/20/closure2#flatMap\"></a></h3><h3 id=\"compactMap\">compactMap( )<a href=\"2019/05/20/closure2#compactMap\"></a></h3><h3 id=\"filter\">filter( )<a href=\"2019/05/20/closure2#filter\"></a></h3><h3 id=\"reduce\">reduce( )<a href=\"2019/05/20/closure2#reduce\"></a></h3><br>\n<br>\n\n<h1 id=\"Map\">Map<a href=\"2019/05/20/closure2#Map\"></a></h1><h4 id=\"陣列元素個數不變-遍歷每個元素，回傳改變的值會替代原本陣列內的值\"><u>陣列元素個數不變, 遍歷每個元素，回傳改變的值會替代原本陣列內的值</u><a href=\"2019/05/20/closure2#陣列元素個數不變-遍歷每個元素，回傳改變的值會替代原本陣列內的值\"></a></h4><p><strong>題目：<br>將原本小寫陣列 <code>[&quot;jack&quot;, &quot;harry&quot;, &quot;john&quot;, &quot;mary&quot;]</code> 的元素轉換成<br>大寫新陣列 <code>[&quot;JACK&quot;, &quot;HARRY&quot;, &quot;JOHN&quot;, &quot;MARY&quot;]</code></strong></p>\n<br>\n\n<h3 id=\"原始做法-for-in-迴圈\">原始做法 (for-in 迴圈)<a href=\"2019/05/20/closure2#原始做法-for-in-迴圈\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> names = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"Harry\"</span>, <span class=\"string\">\"John\"</span>, <span class=\"string\">\"Mary\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">var</span> upperNames = [<span class=\"type\">String</span>]()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> name <span class=\"keyword\">in</span> names &#123;</span><br><span class=\"line\">    upperNames.append(name.uppercased())</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(upperNames) <span class=\"comment\">// [\"JACK\", \"HARRY\", \"JOHN\", \"MARY\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"使用-map\">使用 map<a href=\"2019/05/20/closure2#使用-map\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> names = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"Harry\"</span>, <span class=\"string\">\"John\"</span>, <span class=\"string\">\"Mary\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> upperNames = names.<span class=\"built_in\">map</span> (&#123; (name: <span class=\"type\">String</span>) -&gt; <span class=\"type\">String</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> name.uppercased()</span><br><span class=\"line\">&#125; )</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(upperNames) <span class=\"comment\">// [\"JACK\", \"HARRY\", \"JOHN\", \"MARY\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<h3 id=\"1-Inferring-Type-From-Context\">1. Inferring Type From Context<a href=\"2019/05/20/closure2#1-Inferring-Type-From-Context\"></a></h3><p><strong>系統會推斷出 closure 的 function type <code>(String) -&gt; String</code></strong><br><strong>所以參數型別和返回型別皆可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> names = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"Harry\"</span>, <span class=\"string\">\"John\"</span>, <span class=\"string\">\"Mary\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> upperNames = names.<span class=\"built_in\">map</span> (&#123; name <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> name.uppercased()</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(upperNames) <span class=\"comment\">// [\"JACK\", \"HARRY\", \"JOHN\", \"MARY\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-Implicit-Returns-from-Single-Expression-Closures\">2. Implicit Returns from Single-Expression Closures<a href=\"2019/05/20/closure2#2-Implicit-Returns-from-Single-Expression-Closures\"></a></h3><p><strong>為單一敘述句 <code>return</code> 可以省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> names = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"Harry\"</span>, <span class=\"string\">\"John\"</span>, <span class=\"string\">\"Mary\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> upperNames = names.<span class=\"built_in\">map</span> (&#123; name <span class=\"keyword\">in</span></span><br><span class=\"line\">    name.uppercased()</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(upperNames) <span class=\"comment\">// [\"JACK\", \"HARRY\", \"JOHN\", \"MARY\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"3-Shorthand-Argument-Names\">3. Shorthand Argument Names<a href=\"2019/05/20/closure2#3-Shorthand-Argument-Names\"></a></h3><p><strong>用 $0 替代掉參數 name, 參數列跟 in 關鍵字可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> names = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"Harry\"</span>, <span class=\"string\">\"John\"</span>, <span class=\"string\">\"Mary\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> upperNames = names.<span class=\"built_in\">map</span> (&#123; $<span class=\"number\">0</span>.uppercased() &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(upperNames) <span class=\"comment\">// [\"JACK\", \"HARRY\", \"JOHN\", \"MARY\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"4-Trailing-Closures\">4. Trailing Closures<a href=\"2019/05/20/closure2#4-Trailing-Closures\"></a></h3><p><strong>如果 closure 是最後一個參數可將將大括號的內容移到小括號外</strong><br><strong>因為小括號內沒有其他參數, 所以可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> names = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"Harry\"</span>, <span class=\"string\">\"John\"</span>, <span class=\"string\">\"Mary\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> greetingArray = names.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span>.uppercased() &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(upperNames) <span class=\"comment\">// [\"JACK\", \"HARRY\", \"JOHN\", \"MARY\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<hr>\n<h1 id=\"FlatMap\">FlatMap<a href=\"2019/05/20/closure2#FlatMap\"></a></h1><h4 id=\"FlatMap有兩個比較有趣的功用\">FlatMap有兩個比較有趣的功用<a href=\"2019/05/20/closure2#FlatMap有兩個比較有趣的功用\"></a></h4><h4 id=\"一種是和-map-一樣的功能-但多了篩選掉-nil-的功用-不過-swift-4-1-已經把此功能捨棄-改用-compactMap-取代-更多詳情請參考\"><u>一種是和 map( ) 一樣的功能, 但多了篩選掉 nil 的功用, 不過 swift 4.1 已經把此功能捨棄, 改用 compactMap( ) 取代, 更多詳情請參考:</u><a href=\"2019/05/20/closure2#一種是和-map-一樣的功能-但多了篩選掉-nil-的功用-不過-swift-4-1-已經把此功能捨棄-改用-compactMap-取代-更多詳情請參考\"></a></h4><p><a href=\"https://useyourloaf.com/blog/replacing-flatmap-with-compactmap/\" target=\"_blank\" rel=\"noopener\">Replacing flatMap With compactMap</a></p>\n<h4 id=\"一種是降維度-可將二維陣列降成一維陣列\"><u>一種是降維度, 可將二維陣列降成一維陣列</u><a href=\"2019/05/20/closure2#一種是降維度-可將二維陣列降成一維陣列\"></a></h4><p><strong>題目：<br>將原本二維陣列 <code>[[1], [2, 3], [4, 5, 6], [7, 8, 9, 10]]</code> 的元素轉換成<br>一維陣列陣列 <code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code></strong></p>\n<br>\n\n<h3 id=\"原始做法-雙重for-in迴圈\">原始做法(雙重for-in迴圈)<a href=\"2019/05/20/closure2#原始做法-雙重for-in迴圈\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> twoDimension = [[<span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"><span class=\"keyword\">var</span> oneDimension = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\"><span class=\"keyword\">for</span> arr <span class=\"keyword\">in</span> twoDimension &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> num <span class=\"keyword\">in</span> arr &#123;</span><br><span class=\"line\">        oneDimension.append(num)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(oneDimension) <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"使用-flatMap\">使用 flatMap<a href=\"2019/05/20/closure2#使用-flatMap\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> twoDimension = [[<span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> oneDimension = twoDimension.flatMap (&#123; (nums: [<span class=\"type\">Int</span>]) -&gt; [<span class=\"type\">Int</span>] <span class=\"keyword\">in</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> nums</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(oneDimension) <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"1-Inferring-Type-From-Context-1\">1. Inferring Type From Context<a href=\"2019/05/20/closure2#1-Inferring-Type-From-Context-1\"></a></h3><p><strong>系統會推斷出 closure 的 function type <code>([Int]) -&gt; [Int]</code></strong><br><strong>所以參數型別和返回型別皆可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> twoDimension = [[<span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> oneDimension = twoDimension.flatMap (&#123; nums <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> nums</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(oneDimension) <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-Implicit-Returns-from-Single-Expression-Closures-1\">2. Implicit Returns from Single-Expression Closures<a href=\"2019/05/20/closure2#2-Implicit-Returns-from-Single-Expression-Closures-1\"></a></h3><p><strong>為單一敘述句 <code>return</code> 可以省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> twoDimension = [[<span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> oneDimension = twoDimension.flatMap (&#123; nums <span class=\"keyword\">in</span></span><br><span class=\"line\">    nums</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(oneDimension) <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"3-Shorthand-Argument-Names-1\">3. Shorthand Argument Names<a href=\"2019/05/20/closure2#3-Shorthand-Argument-Names-1\"></a></h3><p><strong>用 $0 替代掉參數 nums, 參數列跟 in 關鍵字可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> twoDimension = [[<span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> oneDimension = twoDimension.flatMap (&#123; $<span class=\"number\">0</span> &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(oneDimension) <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"4-Trailing-Closures-1\">4. Trailing Closures<a href=\"2019/05/20/closure2#4-Trailing-Closures-1\"></a></h3><p><strong>如果 closure 是最後一個參數可將將大括號的內容移到小括號外</strong><br><strong>因為小括號內沒有其他參數, 所以可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> twoDimension = [[<span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>], [<span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> oneDimension = twoDimension.flatMap &#123; $<span class=\"number\">0</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(oneDimension) <span class=\"comment\">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<hr>\n<h1 id=\"compactMap-1\">compactMap<a href=\"2019/05/20/closure2#compactMap-1\"></a></h1><h4 id=\"swift-4-1-新增\"><mark>swift 4.1 新增</mark><a href=\"2019/05/20/closure2#swift-4-1-新增\"></a></h4><h4 id=\"遍歷每個元素，回傳改變後的值會替代原本陣列內的值-如果是-nil-就篩選掉\"><u>###遍歷每個元素，回傳改變後的值會替代原本陣列內的值, 如果是 nil 就篩選掉</u><a href=\"2019/05/20/closure2#遍歷每個元素，回傳改變後的值會替代原本陣列內的值-如果是-nil-就篩選掉\"></a></h4><p><strong>題目：<br>將原本陣列 <code>[&quot;Jack&quot;, &quot;81&quot;, &quot;11&quot;, &quot;5&quot;]</code> 轉換成新陣列 <code>[81, 11, 5]</code></strong></p>\n<br>\n\n<h3 id=\"原始做法-for-in迴圈\">原始做法(for-in迴圈)<a href=\"2019/05/20/closure2#原始做法-for-in迴圈\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> strArray = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"81\"</span>, <span class=\"string\">\"11\"</span>, <span class=\"string\">\"5\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> numberArray = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> strArray &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> num = <span class=\"type\">Int</span>(i) &#123;</span><br><span class=\"line\">        numberArray.append(num) <span class=\"comment\">// Int(\"Jack\") 為 nil, 會被篩選掉</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray) <span class=\"comment\">//[81, 11, 5]</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"使用-compactMap\">使用 compactMap<a href=\"2019/05/20/closure2#使用-compactMap\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numberArray = strArray.compactMap (&#123; (str: <span class=\"type\">String</span>) -&gt; <span class=\"type\">Int?</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"type\">Int</span>(str)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"1-Inferring-Type-From-Context-2\">1. Inferring Type From Context<a href=\"2019/05/20/closure2#1-Inferring-Type-From-Context-2\"></a></h3><p><strong>系統會推斷出 closure 的 function type <code>(Strint) -&gt; Int?</code></strong><br><strong>所以參數型別和返回型別皆可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> strArray = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"81\"</span>, <span class=\"string\">\"11\"</span>, <span class=\"string\">\"5\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> numberArray = strArray.compactMap (&#123; str <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"type\">Int</span>(str)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-Implicit-Returns-from-Single-Expression-Closures-2\">2. Implicit Returns from Single-Expression Closures<a href=\"2019/05/20/closure2#2-Implicit-Returns-from-Single-Expression-Closures-2\"></a></h3><p><strong>為單一敘述句 <code>return</code> 可以省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> strArray = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"81\"</span>, <span class=\"string\">\"11\"</span>, <span class=\"string\">\"5\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> numberArray = strArray.compactMap (&#123; str <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"type\">Int</span>(str)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"3-Shorthand-Argument-Names-2\">3. Shorthand Argument Names<a href=\"2019/05/20/closure2#3-Shorthand-Argument-Names-2\"></a></h3><p><strong>用 $0 替代掉參數 str, 參數列跟 in 關鍵字可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> strArray = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"81\"</span>, <span class=\"string\">\"11\"</span>, <span class=\"string\">\"5\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> numberArray = strArray.compactMap (&#123; <span class=\"type\">Int</span>($<span class=\"number\">0</span>) &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"4-Trailing-Closures-2\">4. Trailing Closures<a href=\"2019/05/20/closure2#4-Trailing-Closures-2\"></a></h3><p><strong>如果 closure 是最後一個參數可將將大括號的內容移到小括號外</strong><br><strong>因為小括號內沒有其他參數, 所以可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> strArray = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"81\"</span>, <span class=\"string\">\"11\"</span>, <span class=\"string\">\"5\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> numberArray = strArray.compactMap &#123; <span class=\"type\">Int</span>($<span class=\"number\">0</span>) &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray)</span><br></pre></td></tr></table></div></figure>\n\n<h2 id=\"進階寫法\"><mark>進階寫法</mark><a href=\"2019/05/20/closure2#進階寫法\"></a></h2><p><strong>如果已經使用 trailing closure 就不適用這一步</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> strArray = [<span class=\"string\">\"Jack\"</span>, <span class=\"string\">\"81\"</span>, <span class=\"string\">\"11\"</span>, <span class=\"string\">\"5\"</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> numberArray = strArray.compactMap(<span class=\"type\">Int</span>.<span class=\"keyword\">init</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(numberArray)</span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<hr>\n<h1 id=\"Filter\">Filter<a href=\"2019/05/20/closure2#Filter\"></a></h1><h4 id=\"遍歷每個元素-會對元素做篩選-假如符合條件-true-放進新陣列-假如條件不符-false-篩選掉\"><u>遍歷每個元素, 會對元素做篩選, 假如符合條件(true)放進新陣列, 假如條件不符(false) 篩選掉</u><a href=\"2019/05/20/closure2#遍歷每個元素-會對元素做篩選-假如符合條件-true-放進新陣列-假如條件不符-false-篩選掉\"></a></h4><p><strong>題目：<br>將原本陣列 <code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code> 篩選出奇數<br>新陣列 <code>[1, 3, 5, 7, 9]</code></strong></p>\n<br>\n\n<h3 id=\"原始做法-for-in迴圈-1\">原始做法(for-in迴圈)<a href=\"2019/05/20/closure2#原始做法-for-in迴圈-1\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">var</span> evenNumbers = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> numbers &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">        evenNumbers.append(i)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(evenNumbers)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"使用-filter\">使用 filter<a href=\"2019/05/20/closure2#使用-filter\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> evenNumber = numbers.<span class=\"built_in\">filter</span>(&#123; (num: <span class=\"type\">Int</span>) -&gt; <span class=\"type\">Bool</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> num % <span class=\"number\">2</span> == <span class=\"number\">0</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(evenNumber)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"1-Inferring-Type-From-Context-3\">1. Inferring Type From Context<a href=\"2019/05/20/closure2#1-Inferring-Type-From-Context-3\"></a></h3><p><strong>系統會推斷出 closure 的 function type <code>(Int) -&gt; Bool</code></strong><br><strong>所以參數型別和返回型別皆可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> evenNumber = numbers.<span class=\"built_in\">filter</span>(&#123; (num) <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> num % <span class=\"number\">2</span> == <span class=\"number\">0</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-Implicit-Returns-from-Single-Expression-Closures-3\">2. Implicit Returns from Single-Expression Closures<a href=\"2019/05/20/closure2#2-Implicit-Returns-from-Single-Expression-Closures-3\"></a></h3><p><strong>為單一敘述句 <code>return</code> 可以省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> evenNumber = numbers.<span class=\"built_in\">filter</span>(&#123; (num) <span class=\"keyword\">in</span></span><br><span class=\"line\">    num % <span class=\"number\">2</span> == <span class=\"number\">0</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(evenNumber)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"3-Shorthand-Argument-Names-3\">3. Shorthand Argument Names<a href=\"2019/05/20/closure2#3-Shorthand-Argument-Names-3\"></a></h3><p><strong>用 $0 替代掉參數 num, 參數列跟 in 關鍵字可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> evenNumber = numbers.<span class=\"built_in\">filter</span>(&#123; $<span class=\"number\">0</span> % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(evenNumber)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"4-Trailing-Closures-3\">4. Trailing Closures<a href=\"2019/05/20/closure2#4-Trailing-Closures-3\"></a></h3><p><strong>如果 closure 是最後一個參數可將將大括號的內容完全移到小括號外</strong><br><strong>因為小括號內沒有其他參數, 所以可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> evenNumber = numbers.<span class=\"built_in\">filter</span>&#123; $<span class=\"number\">0</span> % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(evenNumber)</span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<hr>\n<h1 id=\"Reduce\">Reduce<a href=\"2019/05/20/closure2#Reduce\"></a></h1><h4 id=\"遍歷每個元素，設定初始值-依序加總，最終會回傳一個結果。\"><u>遍歷每個元素，設定初始值, 依序加總，最終會回傳一個結果。</u><a href=\"2019/05/20/closure2#遍歷每個元素，設定初始值-依序加總，最終會回傳一個結果。\"></a></h4><p><strong>題目：<br>將陣列 <code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code> 裡的元素做加總</strong></p>\n<br>\n\n<h3 id=\"原始做法-for-in迴圈-2\">原始做法(for-in迴圈)<a href=\"2019/05/20/closure2#原始做法-for-in迴圈-2\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">var</span> sum = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> numbers &#123;</span><br><span class=\"line\">    sum += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"使用-Reduce-前面的-0-是初始值-result為加總-num-為-每輪加多少\">使用 Reduce, 前面的 0 是初始值, result為加總, num 為 每輪加多少<a href=\"2019/05/20/closure2#使用-Reduce-前面的-0-是初始值-result為加總-num-為-每輪加多少\"></a></h3><figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = numbers.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, &#123;(result: <span class=\"type\">Int</span>, num: <span class=\"type\">Int</span>) -&gt; <span class=\"type\">Int</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result + num</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"1-Inferring-Type-From-Context-4\">1. Inferring Type From Context<a href=\"2019/05/20/closure2#1-Inferring-Type-From-Context-4\"></a></h3><p><strong>系統會推斷出 closure 的 function type (Int, Int) -&gt; Int</strong><br><strong>所以參數型別和返回型別皆可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = numbers.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, &#123; result, num <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result + num</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-Implicit-Returns-from-Single-Expression-Closures-4\">2. Implicit Returns from Single-Expression Closures<a href=\"2019/05/20/closure2#2-Implicit-Returns-from-Single-Expression-Closures-4\"></a></h3><p><strong>為單一敘述句 <code>return</code> 可以省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = numbers.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, &#123; result, num <span class=\"keyword\">in</span></span><br><span class=\"line\">    result + num</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"3-Shorthand-Argument-Names-4\">3. Shorthand Argument Names<a href=\"2019/05/20/closure2#3-Shorthand-Argument-Names-4\"></a></h3><p><strong>用 $0 替代掉參數 result, $1替代掉參數 num</strong><br><strong>參數列跟 in 關鍵字可省略</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = numbers.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, &#123; $<span class=\"number\">0</span> + $<span class=\"number\">1</span> &#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"4-Trailing-Closures-4\">4. Trailing Closures<a href=\"2019/05/20/closure2#4-Trailing-Closures-4\"></a></h3><p><strong>如果 closure 是最後一個參數可將將大括號的內容完全移到小括號外</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = numbers.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>)&#123; $<span class=\"number\">0</span> + $<span class=\"number\">1</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<h2 id=\"最精簡寫法\"><mark>最精簡寫法</mark><a href=\"2019/05/20/closure2#最精簡寫法\"></a></h2><p><strong>當傳入的 closure 有兩個參數且運算子為二元運算子 (+、-、x、÷ …等)<br>使用第1、2、3步驟化簡完, $0, $1 參數可再省略</strong><br><strong>如果已經使用 trailing closure 就不適用這一步</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> numbers = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = numbers.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, +)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"sum = \\(sum)\"</span>) <span class=\"comment\">// sum = 55</span></span><br></pre></td></tr></table></div></figure>\n\n<br>\n<br>\n\n<h1 id=\"組合：\">組合：<a href=\"2019/05/20/closure2#組合：\"></a></h1><h2 id=\"e-g-filter-map\"><u>e.g. ( filter + map )</u><a href=\"2019/05/20/closure2#e-g-filter-map\"></a></h2><p><strong>題目：<br>將 students 陣列中年紀不到 18 歲的列出來</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// filter + map</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> age: <span class=\"type\">Int</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> students = [ </span><br><span class=\"line\">    <span class=\"type\">Person</span>(name: <span class=\"string\">\"Jack\"</span>, age: <span class=\"number\">20</span>), </span><br><span class=\"line\">    <span class=\"type\">Person</span>(name: <span class=\"string\">\"Mary\"</span>, age: <span class=\"number\">17</span>), </span><br><span class=\"line\">    <span class=\"type\">Person</span>(name: <span class=\"string\">\"Harry\"</span>, age: <span class=\"number\">19</span>), </span><br><span class=\"line\">    <span class=\"type\">Person</span>(name: <span class=\"string\">\"John\"</span>, age: <span class=\"number\">15</span>)</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> underEighteen = students.<span class=\"built_in\">filter</span> &#123; $<span class=\"number\">0</span>.age &lt; <span class=\"number\">18</span> &#125;.<span class=\"built_in\">map</span>&#123; $<span class=\"number\">0</span>.name &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(underEighteen) <span class=\"comment\">// [\"Mary\", \"John\"]</span></span><br></pre></td></tr></table></div></figure>\n\n<br>\n\n<h2 id=\"e-g-flatMap-fliter-map-reduce\"><u>e.g. ( flatMap + fliter + map + reduce )</u><a href=\"2019/05/20/closure2#e-g-flatMap-fliter-map-reduce\"></a></h2><p><strong>題目：<br>把<code>[[1, 2, 3], [4, 5, 6, 7], [8, 9, 10]]</code>降維度並篩選陣列裡小於 5 的元素乘於 2 並加總</strong></p>\n<figure class=\"highlight swift\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// flatMap + fliter + map + reduce</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> superArray = [[<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>], [<span class=\"number\">8</span>, <span class=\"number\">9</span>, <span class=\"number\">10</span>]]</span><br><span class=\"line\"><span class=\"keyword\">let</span> sum = superArray.flatMap&#123; $<span class=\"number\">0</span> &#125;.<span class=\"built_in\">filter</span>&#123; $<span class=\"number\">0</span> &lt;= <span class=\"number\">5</span> &#125;.<span class=\"built_in\">map</span>&#123; $<span class=\"number\">0</span> * <span class=\"number\">2</span> &#125;.<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, +)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(sum) <span class=\"comment\">// 30</span></span><br></pre></td></tr></table></div></figure>\n\n","prev":{"title":"Closure in Swift 5 - Part 3 (Escape Closure)","link":"2019/05/23/closure3"},"next":{"title":"Closure in Swift 5 - Part 1 (語法與化簡)","link":"2019/05/18/closure1"},"plink":"http://yoursite.com/2019/05/20/closure2/","toc":[{"title":"常用高階函數 (Higher-order function)","id":"常用高階函數-Higher-order-function","index":"1"},{"title":"Map","id":"Map","index":"2"},{"title":"FlatMap","id":"FlatMap","index":"3"},{"title":"compactMap","id":"compactMap-1","index":"4","children":[{"title":"<mark>進階寫法</mark>","id":"進階寫法","index":"4.1"}]},{"title":"Filter","id":"Filter","index":"5"},{"title":"Reduce","id":"Reduce","index":"6","children":[{"title":"<mark>最精簡寫法</mark>","id":"最精簡寫法","index":"6.1"}]},{"title":"組合：","id":"組合：","index":"7","children":[{"title":"<u>e.g. ( filter + map )</u>","id":"e-g-filter-map","index":"7.1"},{"title":"<u>e.g. ( flatMap + fliter + map + reduce )</u>","id":"e-g-flatMap-fliter-map-reduce","index":"7.2"}]}]}